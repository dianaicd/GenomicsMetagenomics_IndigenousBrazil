# Reference genome
ref_genome:
  "/scratch/axiom/FAC/FBM/DBC/amalaspi/popgen/reference_human/hs.build37.1/hs.build37.1.fa"

#=============================================================================#
# bamdamage
bamdamage:
  bamdamage_fraction: 100000
  Samples:
    Botocudos: "MN*/*.hg19.bam"

#=============================================================================#
# Contamination
Contamination:
  Whole_genome: "hg19"
  contamMix:
    path:
      "~/data/Git/Botocudos-scripts/Contamination/contamMix/exec/estimate.R"
    print_contamMix:
      "~/data/Git/Botocudos-scripts/Contamination/print_contamMix.R"
    nIter:
      1000
    contaminants:
      "~/americas/Panels/MT/311humans.fasta"
    Mitochondrial:
      "MT"
    Samples:
      Diana: "diana.bam"
      # MN00010: "MN00010/MN00010.hg19.bam"
      # MN00013: "MN00013/MN00013.hg19.bam"
      # MN00016: "MN00016/MN00016.hg19.bam"
      # MN00019: "MN00019/MN00019.hg19.bam"
      # MN00021: "MN00021/MN00021.hg19.bam"
      # MN00022: "MN00022/MN00022.hg19.bam"
      # MN00023: "MN00023/MN00023.hg19.bam"
      # MN00039: "MN00039/MN00039.hg19.bam"
      # MN0003: "MN0003/MN0003.hg19.bam"
      # MN00045: "MN00045/MN00045.hg19.bam"
      # MN00056: "MN00056/MN00056.hg19.bam"
      # MN00064: "MN00064/MN00064.hg19.bam"
      # MN00066: "MN00066/MN00066.hg19.bam"
      # MN00067: "MN00067/MN00067.hg19.bam"
      # MN00068: "MN00068/MN00068.hg19.bam"
      # MN00069: "MN00069/MN00069.hg19.bam"
      # MN0008: "MN0008/MN0008.hg19.bam"
      # MN0008: "MN0008/MN0008.hg19.bam"
      # MN0008_L3U: "MN0008/MN0008_L3U.hg19.bam"
      # MN0008_non_U: "MN0008/MN0008_non_U.hg19.bam"
      # MN0009: "MN0009/MN0009.hg19.bam"
      # MN00118: "MN00118/MN00118.hg19.bam"
      # MN00119: "MN00119/MN00119.hg19.bam"
      # MN00316: "MN00316/MN00316.hg19.bam"
      # MN00346: "MN00346/MN00346.hg19.bam"
      # MN01701: "MN01701/MN01701.hg19.bam"
      # MN1943: "MN1943/MN1943.hg19.bam"
      
  contaminationX:
    Samples:
      MN00019: "MN00019/MN00019.hg19.bam"
      MN0003: "MN0003/MN0003.hg19.bam"
      MN00045: "MN00045/MN00045.hg19.bam"
      MN00064: "MN00064/MN00064.hg19.bam"
      MN00067: "MN00067/MN00067.hg19.bam"
      MN00068: "MN00068/MN00068.hg19.bam"
      MN00069: "MN00069/MN00069.hg19.bam"
      MN0008: "MN0008/MN0008.hg19.bam"
      MN0008_L3U: "MN0008/MN0008_L3U.hg19.bam"
      MN0008_non_U: "MN0008/MN0008_non_U.hg19.bam"
      MN0009: "MN0009/MN0009.hg19.bam"
      MN00316: "MN00316/MN00316.hg19.bam"
      MN00346: "MN00346/MN00346.hg19.bam"
      MN01701: "MN01701/MN01701.hg19.bam"
      MN1943: "MN1943/MN1943.hg19.bam"

  schmutzi:
    Mitochondrial:
      "MT"
    Samples:
      Botocudos: "bams/*hg19.bam"

# Minimum base quality to consider for sampling an allele
BaseQuality: 
  20
MapQuality:
  30

#=============================================================================#
# Haplogroups

Haplogroups:
  mt:
    baseQ: 20
    mapQ: 30
    chromosome: "MT"
    Samples:
      Botocudos: "/users/dcruzdav/americas/Botocudos/BAM/2019_11_08/MN*/*hg19.bam"
  y:
    path_goQuery: "/users/dcruzdav/data/Git/Botocudos-scripts/aDNAhaplogroupQuery/goQueryPhylogeny.py"
    path_db: "/users/dcruzdav/data/Git/Botocudos-scripts/aDNAhaplogroupQuery/input/"
    # Diana:
    #   Diana: "../diana.bam"
    Botocudos: 
      MN00019: "bams/MN00019.hg19.bam"
      MN0003: "bams/MN0003.hg19.bam"
      MN00045: "bams/MN00045.hg19.bam"
      MN00064: "bams/MN00064.hg19.bam"
      MN00067: "bams/MN00067.hg19.bam"
      MN00068: "bams/MN00068.hg19.bam"
      MN00069: "bams/MN00069.hg19.bam"
      MN0008: "bams/MN0008.hg19.bam"
      MN0009: "bams/MN0009.hg19.bam"
      MN00316: "bams/MN00316.hg19.bam"
      MN00346: "bams/MN00346.hg19.bam"
      MN01701: "bams/MN01701.hg19.bam"
      MN1943: "bams/MN1943.hg19.bam"

#=============================================================================#
# Heterozygosity
african_het:
  "Nigeria_B_Yoruba-3"
# Path to SGDP (.vcf.gz)
vcf_path:
  "SS6004475.annotated.nh.vcf.gz"

Heterozygosity:
  populations:
    Mbuti:
      HGDP00456: "~/americas/Panels/TeamAB_fclement/HGDP00456.flt.sort.rmdup.realign.md.bam"
      SS6004471: "~/americas/Panels/TeamAB_fclement/SS6004471-dedup.rg.bam"
    Dai:
      SS6004467: "~/americas/Panels/TeamAB_fclement/SS6004467-dedup.rg.bam"
      HGDP01307: "~/americas/Panels/TeamAB_fclement/HGDP01307.flt.sort.rmdup.realign.md.bam"
    French:
      SS6004468: "~/americas/Panels/TeamAB_fclement/SS6004468-dedup.rg.bam"
      HGDP00521: "~/americas/Panels/TeamAB_fclement/HGDP00521.flt.sort.rmdup.realign.md.bam"
    Han:
      SS6004469: "~/americas/Panels/TeamAB_fclement/SS6004469-dedup.rg.bam"
      HGDP00778: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP00778.flt.sort.rmdup.realign.md.bam"
    Mandenka:
      SS6004470: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004470-dedup.rg.bam"
      HGDP01284: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP01284.flt.sort.rmdup.realign.md.bam"
    Papuan:
      SS6004472: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004472-dedup.rg.bam"
      HGDP00542: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP00542.flt.sort.rmdup.realign.md.bam"
    San:
      SS6004473: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004473-dedup.rg.bam"
      HGDP01029: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP01029.flt.sort.rmdup.realign.md.bam"
    Sardinian:
      SS6004474: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004474-dedup.rg.bam"
      HGDP00665: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP00665.flt.sort.rmdup.realign.md.bam"
    Yoruba:
      SS6004475: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004475-dedup.rg.bam"
      HGDP00927: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP00927.flt.sort.rmdup.realign.md.bam"
    Karitiana:
      SS6004476: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004476-dedup.rg.bam"
      HGDP00998: "/users/dcruzdav/americas/Panels/TeamAB_fclement/HGDP00998.flt.sort.rmdup.realign.md.bam"
    Australian:
      SS6004477: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004477-dedup.rg.bam"
      SS6004478: "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004478-dedup.rg.bam"
    Mixe:
      Mixe: "~/americas/fromVictor/Modern/Mixe.bam"
      MixeE: "~/americas/fromVictor/Modern/MixeE.bam"
      MixeF: "~/americas/fromVictor/Modern/MixeF.bam"
    WCD:
      WCD01: "~/americas/fromVictor/Modern/WCD01.bam"
      WCD02: "~/americas/fromVictor/Modern/WCD02.bam"
      WCD03: "~/americas/fromVictor/Modern/WCD03.bam"
      WCD05: "~/americas/fromVictor/Modern/WCD05.bam"
      WCD08: "~/americas/fromVictor/Modern/WCD08.bam"
      WCD13: "~/americas/fromVictor/Modern/WCD13.bam"
    Pima:
      PimaCEPH: "~/americas/fromVictor/Modern/PimaCEPH.bam"
      PimaE: "~/americas/fromVictor/Modern/PimaE.bam"
      PimaF: "~/americas/fromVictor/Modern/PimaF.bam"
    Surui:
      SuruiA: "~/americas/fromVictor/Modern/SuruiA.bam"
      SuruiB: "~/americas/fromVictor/Modern/SuruiB.bam"
    Maya:
      MayaG: "/users/dcruzdav/americas/fromVictor/Modern/MayaG.bam"
      MayaH: "/users/dcruzdav/americas/fromVictor/Modern/MayaH.bam"
    USR:
      USR1: "~/americas/fromVictor/Ancient/USR1.bam"
      USR2: "~/americas/Panels/USR/USR2.bam"
    LagoaSta:
      LagoaSta: "/users/dcruzdav/americas/fromVictor/Ancient/LagoaSta.bam"
      LS4: "/users/dcruzdav/americas/fromVictor/Ancient/LS4.bam"
      LS6: "/users/dcruzdav/americas/fromVictor/Ancient/LS6.bam"
      LS7: "/users/dcruzdav/americas/fromVictor/Ancient/LS7.bam"
      LS8: "/users/dcruzdav/americas/fromVictor/Ancient/LS8.bam"
    Lovelock:
      Lovelock: "~/americas/Panels/Moreno2018b/Lovelock1_final.bam"
      Lovelock2: "~/americas/fromVictor/Ancient/Lovelock2.bam"
      Lovelock3: "~/americas/fromVictor/Ancient/Lovelock3.bam"
    Botocudos:
      MN00010: "boto/MN00010.bam"
      MN00013: "boto/MN00013.bam"
      MN00016: "boto/MN00016.bam"
      MN00019: "boto/MN00019.bam"
      MN00021: "boto/MN00021.bam"
      MN00022: "boto/MN00022.bam"
      MN00023: "boto/MN00023.bam"
      MN00039: "boto/MN00039.bam"
      MN0003: "boto/MN0003.bam"
      MN00045: "boto/MN00045.bam"
      MN00056: "boto/MN00056.bam"
      MN00064: "boto/MN00064.bam"
      MN00066: "boto/MN00066.bam"
      MN00067: "boto/MN00067.bam"
      MN00068: "boto/MN00068.bam"
      MN00069: "boto/MN00069.bam"
      MN0008: "boto/MN0008.bam"
      MN0009: "boto/MN0009.bam"
      MN00118: "boto/MN00118.bam"
      MN00119: "boto/MN00119.bam"
      MN00316: "boto/MN00316.bam"
      MN00346: "boto/MN00346.bam"
      MN01701: "boto/MN01701.bam"
      MN1943: "boto/MN1943.bam"

#=============================================================================#
# Relatedness with realSFS

relatedness:
  nThreads: 3
  ancestral: "chimpHg19.fa"
  minQ: 20
  minMapQ: 30
  Samples:
    MN00056: "bams/MN00056.hg19.bam"
    MN0008: "bams/MN0008.hg19.bam"
  Sites:
    test: "subset_test.txt"
optim_sfs_mem: 250
optim_sfs_time: 2

#=============================================================================#
# Runs of homozygosity in plink
roh_plink:
  bamlists:
    MN0008: "MN0008"
    SuruiA: 'SuruiA'
    SuruiB: 'SuruiB'
    Karitiana: 'Karitiana'
    KaritianaB: 'KaritianaB'
    KaritianaBI16: 'KaritianaBI16'
    KaritianaG: 'KaritianaG'
    KaritianaH: 'KaritianaH'

  # filters:
    # window_kb:
    #   5000
    # window_snp:
    #   50
    # hets_window:  
    #   1
    # window_missing: 
    #   5
    # window_threshold: 
    #   0.05
    # segment_snp:  
    #   100
    # segment_kb: 
    #   1000
    # segment_density:  
    #   50 # kb^-1, i.e., 1 SNP per 50kb
    # homozyg_gap:
    #   1000
    
#=============================================================================#
# PSMC
psmc:
  path_utils: "/users/dcruzdav/Project_popgen/americas/install/psmc/utils"
  samples:
    # MN0008: "10/MN0008.bam"
    LagoaSta_15x: "15/LagoaSta_15x.bam"
    Karitiana_15x: "15/Karitiana_15x.bam"
    KaritianaB_15x: "15/KaritianaB_15x.bam"
    KaritianaBI16_15x: "15/KaritianaBI16_15x.bam"
    KaritianaG_15x: "15/KaritianaG_15x.bam"
    KaritianaH_15x: "15/KaritianaH_15x.bam"
    MayaG_15x: "15/MayaG_15x.bam"
    MayaH_15x: "15/MayaH_15x.bam"
    Mixe_15x: "15/Mixe_15x.bam"
    MixeE_15x: "15/MixeE_15x.bam"
    MixeF_15x: "15/MixeF_15x.bam"
    PimaCEPH_15x: "15/PimaCEPH_15x.bam"
    PimaE_15x: "15/PimaE_15x.bam"
    PimaF_15x: "15/PimaF_15x.bam"
    SuruiA_15x: "15/SuruiA_15x.bam"
    SuruiB_15x: "15/SuruiB_15x.bam"
    USR1_15x: "15/USR1_15x.bam"

# in GB
psmc_consensus_mem: 4
psmc_consensus_time: 48
psmc_consensus_threads: 8
#=============================================================================#
# AdmixTools
f3:
  panel:
    Nov2019_Maanasa_mask1_flip:
      # bed, vcf, bim
      type:
          "bed"
      path: 
          "Nov2019_Maanasa_mask1_flip.bed"
  Outgroup:
    "Yorubas"
  # This file should have a column with indId and
  # one column with population ID
  ind_pop: 
    "ind_pop.txt"
  # qp3pop
  Source1:
    "Source1.txt"
  Source2:
    "Source2.txt"

# qpDstat
H1: 
  "h1.txt"
H2: 
  "h2.txt"
H3: 
  "h3.txt"
max_files_per_dir:
  100
max_lines:
  10

#=============================================================================#
# Enhanced D-statistics
enhanced:
  chimp_variants:
    "chimpHg19.variants"
  max_missing:
    0.5
  panel:
    "h_merged.bed"
  # Variants to enhance for a Neanderthal introgression test
  # Outgroup is chimp, make sure to have ancestral variants
  tests:
    35Africans_Meyer2012:
      Outgroup:
        "chimpHg19.fa"
      H3:
        "AltaiNea"
      Human_not_introgressed:
        "35Africans_Meyer2012"

#=============================================================================#
# Error rates in ANGSD
error_angsd:
  Outgroup_file:
    # "/users/dcruzdav/americas/fromVictor/Modern/Yoruba.bam"
    "/users/dcruzdav/americas/Panels/ANGSD/chimpHg19.fa"
  Perfect_file:
    "/users/dcruzdav/americas/Panels/TeamAB_fclement/SS6004480-dedup.rg.bam"
  
    # "/users/dcruzdav/americas/d/diana.bam"
    # "/users/dcruzdav/americas/Panels/Perfect_sample/NA12778.fa"
  minQ_perfect: 30
  bamlists:
    # BronzeAge_Greece:
      # all: "BA*/*bam"
      # capture: "/scratch/axiom/FAC/FBM/DBC/amalaspi/bronzeage_greece/sneuensc/mapping_nuclear_capture_20190118/*_cap_regions.bam"
      # untrimmed: "/scratch/axiom/FAC/FBM/DBC/amalaspi/bronzeage_greece/sneuensc/mapping_wgs_201901021/"
      # trimmed: "/scratch/axiom/FAC/FBM/DBC/amalaspi/bronzeage_greece/sneuensc/mapping_trim_wgs_5bp_20190709/*bam"
    Botocudos:
      all: "Botocudos/*hg19.bam"
    Sambaqui:
      Sambaqui: "~/americas/Botocudos/BAM/2019_11_08/MN01701/MN01701_L1L2.hg19.bam"
    MinasGerais:
      MG: "~/americas/Botocudos/BAM/2019_11_08/MN1943/MN1943_L1.hg19.bam"
    Botocudos_trim:
      all: "Botocudos_trim/*hg19.bam"
    Sambaqui_trim:
      Sambaqui: "~/americas/Botocudos/BAM/Trimmed/2019_11_11/MN01701/MN01701_L1L2.hg19.bam"
    MinasGerais_trim:
      MG: "~/americas/Botocudos/BAM/Trimmed/2019_11_11/MN1943/MN1943_L1.hg19.bam"
    # LagoaSanta:
    #   Lagoa_high: "LagoaSta.bam"
    #   Lagoa_4: "LS4.bam"
#=============================================================================#
# Abbababa multipop

# Outgroup and Perfect sample for error estimation
# The files can be in bam or fasta format.
# If bam is given, the error_angsd.smk will generate a fasta file
# in case a fasta is not already in the working directory.
Outgroup_file:
  "Yoruba.bam"
Perfect_file:
  "NA12778.fa"
abbababa_threads:
  10
ancError_threads:
  16
BlockSize:
  5e6
#=============================================================================#
# Genotype calling
# Use Víctor's lines to call genotype: ("Yes" | "No")
geno_calls:
  bamlists:
    MN0008:

            MN0008: '~/americas/Botocudos/BAM/2019_09_23/MN0008/MN0008.bam'
    SuruiA:

            SuruiA: '~/americas/fromVictor/Modern/SuruiA.bam'
    SuruiB:

            SuruiB: '~/americas/fromVictor/Modern/SuruiB.bam'
    Karitiana:

            Karitiana: '~/americas/fromVictor/Modern/Karitiana.bam'
    KaritianaB:

            KaritianaB: '~/americas/fromVictor/Modern/KaritianaB.bam'
    KaritianaBI16:

            KaritianaBI16: '~/americas/fromVictor/Modern/KaritianaBI16.bam'
    KaritianaG:

            KaritianaG: '~/americas/fromVictor/Modern/KaritianaG.bam'
    KaritianaH:

            KaritianaH: '~/americas/fromVictor/Modern/KaritianaH.bam'

Genos_Moreno2019:
  "Yes"

#=============================================================================#
# Sampling alleles
#
# Chromosomes included in the panel
#chromosomes: list(range(1, 23)) # 23 not nicluded in python

#------------------------------------------------------------------------------#
# Merge lists of bam files and panels
merge_sample:
  # Should all observed alleles be considered when computing 
  # allele frequencies to sample a base
  # "" or "--allmutations"
  allmutations: 
    ""
# Each value defined for bamlists will lead to merging all the bam files
# defined in the path to each panel.
  bamlists:
      Jan2020:
          24Samples: "~/americas/Botocudos/BAM/2019_11_08/*/*hg19.bam"
          sapfo14: "~/americas/Panels/fromAnna/BAM/*bam"
          vicAncient: "~/americas/fromVictor/Ancient/*bam"
          vicModern: "~/americas/fromVictor/Modern/*bam"
          Posth: "~/americas/Panels/Posth2018/final_bam/*bam"
      Jan2020_trimmed:
          24Samples: "~/americas/Botocudos/BAM/Trimmed/2019_11_11/*/*hg19.bam"
          sapfo14: "~/americas/Panels/fromAnna/BAM/*bam"
          vicAncient: "~/americas/fromVictor/Ancient/*bam"
          vicModern: "~/americas/fromVictor/Modern/*bam"
          Posth: "~/americas/Panels/Posth2018/final_bam/*bam"
              
#-----------------------------------------------------------------------------#
# Panel(s) to which samples will be merged
  panels: 
      Maanasa_mask1_flip: 
          # bed, vcf, bim
          type:
              "bed"
          path: 
              "Maanasa_mask1_flip.bed"
      Wollstein_mind0.95_rmtrans:
          type:
              "bed"
          path:
              "Wollstein_mind0.95_rmtrans.bed"
      #     NGSAdmix:
      #         run: "yes"
      #         K: 15
      #         rep: 100

      # h:
      #     type: 
      #         "bed"
      #     path: 
      #         "h.bed"
      #     GenoLike:
      #          homozygous: "yes"
      #          rmdamage: "yes"
      

      #     GenoLike:
      #         homozygous: "yes"
      #         rmdamage: "yes"

      # v37.2.1240K_HumanOrigins:
      #     type:
      #         "ped"
      #     path:
      #         "v37.2.1240K_HumanOrigins.ped"
      #     GenoLike:
      #         homozygous: "yes"
      #         rmdamage: "yes"
#==============================================================================#
# Genotype likelihoods
geno_like:
  nThreads:
    8
  panels: 
    Wollstein_mind0.95_rmtrans:
      type:
          "bed"
      path:
          "/users/dcruzdav/americas/Botocudos/Merge/2019_11_28/Wollstein_mind0.95_rmtrans.bed"
      homozygous: "yes"
      rmdamage: "yes"

  bamlists:
    Nov2019:
      minQ: 20
      minmapQ: 30
      trim: ""
      paths:
          24Botocudos: "~/americas/Botocudos/BAM/2019_11_08/*/*hg19.bam"
          sapfo14: "~/americas/Panels/fromAnna/BAM/*bam"
          vicAncient: "~/americas/fromVictor/Ancient/*bam"
          # vicModern: "~/americas/fromVictor/Modern/*bam"
          Posth: "~/americas/Panels/Posth2018/final_bam/*bam"

#==============================================================================#
# NGS Admix
ngs_admix:
  panels:
    # Nov2019_Wollstein_mind0.95_rmtrans: 
    #   path: "Nov2019_Wollstein_mind0.95_rmtrans.beagle"
    #   max_K: 10
    #   replicates: 100
    Wollstein_200ind_Diana:
      path: "../genotypes/Merged/Wollstein_200ind_Diana.beagle"
      max_K: 10
      min_K: 5
      replicates: 20
      


#==============================================================================#
# Downsample data

downsample:
  mem_sort:
    "32G"
  depths: ""
  groups:
    LagoaSta: "LagoaSta.bam"
    # Australian
    # Dai
    # French
    # Han
    Karitiana: "Karitiana.bam"
    KaritianaB: "KaritianaB.bam"
    KaritianaBI16: "KaritianaBI16.bam"
    KaritianaG: "KaritianaG.bam"
    KaritianaH: "KaritianaH.bam"
    # Lovelock
    # Mandenka
    MayaG: "MayaG.bam"
    MayaH: "MayaH.bam"
    # Mbuti
    Mixe: "Mixe.bam"
    MixeE: "MixeE.bam"
    MixeF: "MixeF.bam"
    # Papuan
    PimaCEPH: "PimaCEPH.bam"
    PimaE: "PimaE.bam"
    PimaF: "PimaF.bam"
    # San
    # Sardinian
    SuruiA: "SuruiA.bam"
    SuruiB: "SuruiB.bam"
    USR1: "USR1.bam"
    # WCD
    # Yoruba
    
#=============================================================================#
# Microbiome
Microbiome:
  bam2fastq:
    Samples: "~/americas/Botocudos/BAM/2019_11_08/*/*low_qual.bam"